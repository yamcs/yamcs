<app-admin-page>
  <app-admin-toolbar>
    Admin Home
    &nbsp;&nbsp;&nbsp;
    <button mat-icon-button
            color="primary"
            (click)="refresh()"
            matTooltip="Refresh view">
      <mat-icon>refresh</mat-icon>
    </button>
  </app-admin-toolbar>

  <div class="panel-content" *ngIf="info$ | async as info">
    <dl class="dl-horizontal" style="margin-top: 0">
      <dt>Yamcs version</dt>
      <dd>{{ info.yamcsVersion }}</dd>
      <dt>Build</dt>
      <dd>{{ info.revision }}</dd>
      <dt>Server ID</dt>
      <dd>{{ info.serverId }}</dd>
    </dl>
    <dl class="dl-horizontal">
      <dt>OS</dt>
      <dd>{{ info.os }}</dd>
      <dt>Architecture</dt>
      <dd>{{ info.arch }}</dd>
      <dt>JVM</dt>
      <dd>{{ info.jvm }}</dd>
    </dl>
    <dl class="dl-horizontal">
      <dt>Working directory</dt>
      <dd>{{ info.workingDirectory }}</dd>
      <dt>Config directory</dt>
      <dd>{{ info.configDirectory }}</dd>
      <dt>Cache directory</dt>
      <dd>{{ info.cacheDirectory }}</dd>
      <dt>Data directory</dt>
      <dd>{{ info.dataDirectory }}</dd>
    </dl>
    <dl class="dl-horizontal">
      <dt>Uptime</dt>
      <dd>{{ info.uptime | duration }}</dd>
      <dt>Load average</dt>
      <dd>{{ info.loadAverage | number:'1.2-2' }}</dd>
      <dt>Available processors</dt>
      <dd>{{ info.availableProcessors }}</dd>
      <dt>Heap memory</dt>
      <dd>
        {{ info.heapMemory | formatBytes }}
        (used: {{ (info.usedHeapMemory / info.heapMemory) | percent }},
        limit: {{ (info.maxHeapMemory | formatBytes) || 'n/a' }})</dd>
      <dt>Non-heap memory</dt>
      <dd>
          {{ info.nonHeapMemory | formatBytes }}
          (used: {{ (info.usedNonHeapMemory / info.nonHeapMemory) | percent }},
          limit: {{ (info.maxNonHeapMemory | formatBytes) || 'n/a' }})</dd>
      <dt>Thread count</dt>
      <dd>{{ info.jvmThreadCount }}</dd>
    </dl>
    <h4>Root directories</h4>
    <table yaDataTable>
      <tr>
        <th>Directory</th>
        <th>Type</th>
        <th>Total space</th>
        <th>Unallocated space</th>
        <th>Usable space</th>
      </tr>
      <tr *ngFor="let root of info.rootDirectories">
        <td>{{ root.directory }}</td>
        <td>{{ root.type || '-' }}</td>
        <td>{{ root.totalSpace | formatBytes }}</td>
        <td>{{ root.unallocatedSpace | formatBytes }}</td>
        <td>{{ root.usableSpace | formatBytes }}</td>
      </tr>
    </table>
  </div>
</app-admin-page>
