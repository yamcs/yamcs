<chapter id="eventviewer">
<title>Event Viewer</title>
<para>The Event Viewer displays events from the Yamcs Server. In older versions of Yamcs, the Event Viewer was in fact decoding and displaying on-board events only. Now the Event Viewer is just a display, the decoder being another component that runs inside the Yamcs Server (thus the events are decoded and saved in the archive even if no viewer is running). In addition, more and more components of Yamcs generate events (for example the DaSS TM/PP/TC components) when significant things happen.</para>


<section><title>Installing</title>

	<section><title>Dependencies</title>
	<variablelist>
	    <varlistentry><term>OS</term>
			<listitem>Linux or Windows, 32bit or 64bit</listitem>
		</varlistentry>
	    
	    <varlistentry><term>Java runtime (JRE)</term>
			<listitem>>= version 1.6</listitem>
		</varlistentry>
	</variablelist>
	</section>

	<section><title>Installation</title>
		<para>The Event Viewer is delivered as part of an archived client tools package. The package does not need to be installed, just extracted to a suitable location. The tools can be run from the extracted location using starting scripts found in the <filename>bin/</filename> folder.</para>
	</section>

	<section><title>Configuration</title>
		<para>No further configuration is needed, but you may specify a custom sound file to be used when an event with "sound alert" enabled is received. In this case, edit the <filename>etc/event-viewer.yaml</filename> file in the extracted location and change <emphasis>soundfile</emphasis> entry to a full path to a WAV format sound file.</para>
	</section>


	<section><title>Updating</title>
		<para>Updated applications are made available as an archived client tools package. This should be extracted into its own folder, separate to any previous installation. The configuration files in <filename>etc/</filename> can be copied from a previous installation into the new installation.</para>
	</section>
	
	<section><title>Removing</title>
		<para>To remove an installation, delete the extracted folder.</para>
	</section>
</section>


<section><title>Starting the Event Viewer</title>

<para>The event viewer is started with the command 
        <command>event-viewer.sh</command> or <command>event-viewer.bat</command></para>
        <para>
            After the startup, the menu entry <guimenu>File->Connect</guimenu> has to be used to connect to the Yamcs server.
        </para>
		<para>A URL can be provided on the command line to connect directly after the startup, without needint to connect from the menu:
            <screen>event-viewer.sh yamcs://localhost:5445/instance</screen>
        </para>
</section>
<section><title>User interface</title>
    <figure><title>Event Viewer</title>
    <mediaobject>
      <imageobject> <imagedata width="100%" fileref="images/event-viewer.png" format="PNG"/> </imageobject>
    </mediaobject>
    </figure>
    <para>
        The Event Viewer main part is a table of events displayed in the order in which they are received from the Yamcs Server. Each event is displayed as one line in the table with the following properties:
    </para>
    <itemizedlist>
        <listitem>Source - represents the system or subsystem that generated the event (e.g. EDR, DaSSPacketProvider)</listitem>
        <listitem>Generation Time - the time when the event was generated.</listitem>
        <listitem>Reception Time - the time when the event has been received by Yamcs. For the events generated by the Yamcs components this is the same as the Generation time.</listitem>
        <listitem>Event Type - an indicative type that depends on the source of the event.</listitem>
        <listitem>Event Text - a "human readable" text.</listitem>
    </itemizedlist>
    <para>
        In order to be able to display only relevant events, a filtering mechanism has been introduced.
    </para>
    <figure><title>Event filtering</title>
    <mediaobject>
      <imageobject> <imagedata width="100%" fileref="images/event-viewer-filters.png" format="PNG"/> </imageobject>
    </mediaobject>
    </figure>
    <para> 
        The filters can be changed by selecting <guimenu>Edit->Preferences</guimenu>. Each filter can be applied on any of the Source, Type or Text properties of an event and can have a sound or popup alert properties. The Show = Yes/No means that the events matching the filter will be shown or not in the Event Viewer.
    </para>
    <para>
        When the Event Viewer receives an event, it applies one by one all the filters until one matches. If a filter matches, then it is shown or not depending on the Show option. Independent of the Show option, if the matching filter has specified an alarm or a popup, the action is performed. If no filter matches, then by default the event is shown. 
    </para>
    <para>
        The filters can be activated or disabled in the preferences or by using the View menu. The filters that are not active, are ignored by the Event Viewer and not matched against incoming events.
    </para>
    <para>
        The menu <guimenu>File->Save as</guimenu> allows to save the displayed events into a tab-separated file. The first line of the file is the header containing the column names as shown in the table.
    </para> 
    <para>
        The menu <guimenu>File->Retrieve Past Events</guimenu> pops up a dialog allowing to select a start/end range for retrieving events from the archive. All the retrieved events are subjected to the filters on the client side. In the future, the server might be improved to apply the filters directly on the server.
    </para> 
</section>

</chapter>
